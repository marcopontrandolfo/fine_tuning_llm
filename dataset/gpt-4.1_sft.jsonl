{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Elenca i 10 clienti con più ordini (lifetime)"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Customer c ON o.custId = c.custId\nGROUP BY c.custId, c.companyName\nORDER BY ordersCount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Mostra i 10 prodotti più venduti per quantità (lifetime)"}, {"role": "assistant", "content": "SELECT p.productName, SUM(od.quantity) AS qty\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nGROUP BY p.productId, p.productName\nORDER BY qty DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Calcola il fatturato per shipCountry (ricavo = quantity*unitPrice*(1-discount))"}, {"role": "assistant", "content": "SELECT o.shipCountry,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount, 0))) AS revenue\nFROM SalesOrder o\nJOIN OrderDetail od ON o.orderId = od.orderId\nGROUP BY o.shipCountry\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ritardo medio di spedizione in giorni (shippedDate - requiredDate)"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(o.shippedDate, o.requiredDate)) AS avgDelayDays\nFROM SalesOrder o;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Quanti ordini hanno almeno una riga con sconto > 0.2?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.orderId) AS ordersWithHighDiscount\nFROM OrderDetail od\nWHERE od.discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 5 dipendenti per numero di ordini gestiti"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nGROUP BY e.employeeId, e.firstname, e.lastname\nORDER BY ordersCount DESC\nLIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato per categoria prodotto"}, {"role": "assistant", "content": "SELECT cat.categoryName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount, 0))) AS revenue\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di prodotti per fornitore (ordina discendente)"}, {"role": "assistant", "content": "SELECT s.companyName, COUNT(*) AS productsCount\nFROM Product p\nJOIN Supplier s ON p.supplierId = s.supplierId\nGROUP BY s.supplierId, s.companyName\nORDER BY productsCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Sconto medio per categoria"}, {"role": "assistant", "content": "SELECT cat.categoryName, AVG(COALESCE(od.discount, 0)) AS avgDiscount\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY avgDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti senza ordini (mai)"}, {"role": "assistant", "content": "SELECT c.custId, c.companyName\nFROM Customer c\nLEFT JOIN SalesOrder o ON o.custId = c.custId\nWHERE o.orderId IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Distribuzione degli ordini per mese (YYYY-MM)"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS ordersCount\nFROM SalesOrder o\nGROUP BY ym\nORDER BY ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Valore medio per ordine per shipCountry"}, {"role": "assistant", "content": "SELECT o.shipCountry,\n       AVG(order_total) AS avgOrderValue\nFROM (\n  SELECT od.orderId,\n         SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS order_total\n  FROM OrderDetail od\n  GROUP BY od.orderId\n) t\nJOIN SalesOrder o ON o.orderId = t.orderId\nGROUP BY o.shipCountry\nORDER BY avgOrderValue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti esauriti (unitsInStock=0) e unitsOnOrder (desc)"}, {"role": "assistant", "content": "SELECT p.productName, p.unitsInStock, p.unitsOnOrder\nFROM Product p\nWHERE p.unitsInStock = 0\nORDER BY p.unitsOnOrder DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Corrieri con più spedizioni (conteggio ordini)"}, {"role": "assistant", "content": "SELECT s.companyName, COUNT(*) AS shipments\nFROM SalesOrder o\nJOIN Shipper s ON o.shipperid = s.shipperId\nGROUP BY s.shipperId, s.companyName\nORDER BY shipments DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti mai ordinati"}, {"role": "assistant", "content": "SELECT p.productId, p.productName\nFROM Product p\nLEFT JOIN OrderDetail od ON od.productId = p.productId\nWHERE od.orderId IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 10 clienti per fatturato (lifetime)"}, {"role": "assistant", "content": "SELECT c.companyName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount, 0))) AS revenue\nFROM SalesOrder o\nJOIN Customer c ON o.custId = c.custId\nJOIN OrderDetail od ON o.orderId = od.orderId\nGROUP BY c.custId, c.companyName\nORDER BY revenue DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di dipendenti per regione (via territori)"}, {"role": "assistant", "content": "SELECT r.regiondescription AS region, COUNT(DISTINCT e.employeeId) AS employees\nFROM Employee e\nJOIN EmployeeTerritory et ON e.employeeId = et.employeeId\nJOIN Territory t ON et.territoryId = t.territoryId\nJOIN Region r ON t.regionId = r.regionId\nGROUP BY r.regionId, r.regiondescription\nORDER BY employees DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini con freight superiore alla media"}, {"role": "assistant", "content": "SELECT o.orderId, o.freight, o.shipCountry\nFROM SalesOrder o\nWHERE o.freight > (SELECT AVG(freight) FROM SalesOrder);"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero medio di righe per ordine"}, {"role": "assistant", "content": "SELECT AVG(items_per_order) AS avgItems\nFROM (\n  SELECT od.orderId, COUNT(*) AS items_per_order\n  FROM OrderDetail od\n  GROUP BY od.orderId\n) x;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di clienti per paese"}, {"role": "assistant", "content": "SELECT c.country, COUNT(*) AS customers\nFROM Customer c\nGROUP BY c.country\nORDER BY customers DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti per categoria (conteggio)"}, {"role": "assistant", "content": "SELECT cat.categoryName, COUNT(*) AS products\nFROM Product p\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY products DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per dipendente e mese (YYYY-MM)"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname, DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nGROUP BY e.employeeId, e.firstname, e.lastname, ym\nORDER BY e.lastname, e.firstname, ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 10 paesi di spedizione per numero ordini"}, {"role": "assistant", "content": "SELECT o.shipCountry, COUNT(*) AS ordersCount\nFROM SalesOrder o\nGROUP BY o.shipCountry\nORDER BY ordersCount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti con stock <= reorderLevel"}, {"role": "assistant", "content": "SELECT p.productName, p.unitsInStock, p.reorderLevel\nFROM Product p\nWHERE p.unitsInStock <= p.reorderLevel\nORDER BY p.unitsInStock ASC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Valore totale ordini per cliente"}, {"role": "assistant", "content": "SELECT c.companyName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM Customer c\nJOIN SalesOrder o ON o.custId = c.custId\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY c.custId, c.companyName\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fornitori per paese (conteggio)"}, {"role": "assistant", "content": "SELECT s.country, COUNT(*) AS suppliers\nFROM Supplier s\nGROUP BY s.country\nORDER BY suppliers DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Sconto medio per shipCountry"}, {"role": "assistant", "content": "SELECT o.shipCountry, AVG(COALESCE(od.discount,0)) AS avgDiscount\nFROM SalesOrder o\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY o.shipCountry\nORDER BY avgDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Coppie di prodotti più ordinate insieme (top 10 per supporto)"}, {"role": "assistant", "content": "SELECT p1.productName AS productA, p2.productName AS productB, COUNT(*) AS jointOrders\nFROM OrderDetail a\nJOIN OrderDetail b ON a.orderId = b.orderId AND a.productId < b.productId\nJOIN Product p1 ON a.productId = p1.productId\nJOIN Product p2 ON b.productId = p2.productId\nGROUP BY p1.productId, p1.productName, p2.productId, p2.productName\nORDER BY jointOrders DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini spediti in ritardo (shippedDate > requiredDate)"}, {"role": "assistant", "content": "SELECT o.orderId, o.orderDate, o.requiredDate, o.shippedDate\nFROM SalesOrder o\nWHERE o.shippedDate > o.requiredDate;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ritardo medio per shipCountry (giorni)"}, {"role": "assistant", "content": "SELECT o.shipCountry, AVG(DATEDIFF(o.shippedDate, o.requiredDate)) AS avgDelay\nFROM SalesOrder o\nGROUP BY o.shipCountry\nORDER BY avgDelay DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero ordini e ultima data ordine per cliente"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(o.orderId) AS ordersCount, MAX(o.orderDate) AS lastOrder\nFROM Customer c\nLEFT JOIN SalesOrder o ON o.custId = c.custId\nGROUP BY c.custId, c.companyName\nORDER BY ordersCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ricavo per prodotto con categoria"}, {"role": "assistant", "content": "SELECT p.productName, cat.categoryName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY p.productId, p.productName, cat.categoryId, cat.categoryName\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Spedizioni per corriere e mese"}, {"role": "assistant", "content": "SELECT s.companyName, DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS shipments\nFROM SalesOrder o\nJOIN Shipper s ON o.shipperid = s.shipperId\nGROUP BY s.shipperId, s.companyName, ym\nORDER BY s.companyName, ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato per dipendente"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY e.employeeId, e.firstname, e.lastname\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti per regione (campo region di Customer)"}, {"role": "assistant", "content": "SELECT c.region, COUNT(*) AS customers\nFROM Customer c\nGROUP BY c.region\nORDER BY customers DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per shipCity"}, {"role": "assistant", "content": "SELECT o.shipCity, COUNT(*) AS ordersCount\nFROM SalesOrder o\nGROUP BY o.shipCity\nORDER BY ordersCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prezzo medio unitario per categoria prodotto"}, {"role": "assistant", "content": "SELECT cat.categoryName, AVG(p.unitPrice) AS avgPrice\nFROM Product p\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY avgPrice DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti con il maggior numero di prodotti distinti acquistati"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(DISTINCT od.productId) AS distinctProducts\nFROM Customer c\nJOIN SalesOrder o ON o.custId = c.custId\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY c.custId, c.companyName\nORDER BY distinctProducts DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per prodotto e mese (conteggio righe d'ordine)"}, {"role": "assistant", "content": "SELECT p.productName, DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS lineCount\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN SalesOrder o ON od.orderId = o.orderId\nGROUP BY p.productId, p.productName, ym\nORDER BY p.productName, ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Categorie con sconto medio più alto"}, {"role": "assistant", "content": "SELECT cat.categoryName, AVG(COALESCE(od.discount,0)) AS avgDiscount\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY avgDiscount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti senza numero di telefono"}, {"role": "assistant", "content": "SELECT c.custId, c.companyName\nFROM Customer c\nWHERE c.phone IS NULL OR c.phone = '';"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per dipendente con percentuale di ritardo"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname, COUNT(*) AS ordersCount,\n       AVG(CASE WHEN o.shippedDate > o.requiredDate THEN 1 ELSE 0 END) AS lateRate\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nGROUP BY e.employeeId, e.firstname, e.lastname\nORDER BY lateRate DESC, ordersCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fornitori che coprono più categorie (prodotti)"}, {"role": "assistant", "content": "SELECT s.companyName, COUNT(DISTINCT p.categoryId) AS categories\nFROM Supplier s\nJOIN Product p ON p.supplierId = s.supplierId\nGROUP BY s.supplierId, s.companyName\nORDER BY categories DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Freight medio per corriere"}, {"role": "assistant", "content": "SELECT s.companyName, AVG(o.freight) AS avgFreight\nFROM SalesOrder o\nJOIN Shipper s ON o.shipperid = s.shipperId\nGROUP BY s.shipperId, s.companyName\nORDER BY avgFreight DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di prodotti per paese del fornitore"}, {"role": "assistant", "content": "SELECT s.country, COUNT(*) AS products\nFROM Product p\nJOIN Supplier s ON p.supplierId = s.supplierId\nGROUP BY s.country\nORDER BY products DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di clienti per tipo demografico (se presenti)"}, {"role": "assistant", "content": "SELECT d.customerTypeId, COUNT(DISTINCT ccd.custId) AS customers\nFROM CustomerDemographics d\nJOIN CustCustDemographics ccd ON ccd.customerTypeId = d.customerTypeId\nGROUP BY d.customerTypeId\nORDER BY customers DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Dipendenti per titolo professionale (title)"}, {"role": "assistant", "content": "SELECT e.title, COUNT(*) AS employees\nFROM Employee e\nGROUP BY e.title\nORDER BY employees DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 10 clienti per numero ordini negli ultimi 12 mesi"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Customer c ON o.custId = c.custId\nWHERE o.orderDate >= DATE_SUB(CURDATE(), INTERVAL 12 MONTH)\nGROUP BY c.custId, c.companyName\nORDER BY ordersCount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato mensile (YYYY-MM)"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.orderDate, '%Y-%m') AS ym,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM SalesOrder o\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY ym\nORDER BY ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ultima data di spedizione per cliente"}, {"role": "assistant", "content": "SELECT c.companyName, MAX(o.shippedDate) AS lastShipped\nFROM Customer c\nJOIN SalesOrder o ON o.custId = c.custId\nGROUP BY c.custId, c.companyName\nORDER BY lastShipped DESC;"}]}
