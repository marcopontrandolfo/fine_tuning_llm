{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Elenca i 10 clienti con più ordini (lifetime)"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Customer c ON o.custId = c.custId\nGROUP BY c.custId, c.companyName\nORDER BY ordersCount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Mostra i 10 prodotti più venduti per quantità (lifetime)"}, {"role": "assistant", "content": "SELECT p.productName, SUM(od.quantity) AS qty\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nGROUP BY p.productId, p.productName\nORDER BY qty DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Calcola il fatturato per shipCountry (ricavo = quantity*unitPrice*(1-discount))"}, {"role": "assistant", "content": "SELECT o.shipCountry,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount, 0))) AS revenue\nFROM SalesOrder o\nJOIN OrderDetail od ON o.orderId = od.orderId\nGROUP BY o.shipCountry\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ritardo medio di spedizione in giorni (shippedDate - requiredDate)"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(o.shippedDate, o.requiredDate)) AS avgDelayDays\nFROM SalesOrder o;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Quanti ordini hanno almeno una riga con sconto > 0.2?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.orderId) AS ordersWithHighDiscount\nFROM OrderDetail od\nWHERE od.discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 5 dipendenti per numero di ordini gestiti"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nGROUP BY e.employeeId, e.firstname, e.lastname\nORDER BY ordersCount DESC\nLIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato per categoria prodotto"}, {"role": "assistant", "content": "SELECT cat.categoryName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount, 0))) AS revenue\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di prodotti per fornitore (ordina discendente)"}, {"role": "assistant", "content": "SELECT s.companyName, COUNT(*) AS productsCount\nFROM Product p\nJOIN Supplier s ON p.supplierId = s.supplierId\nGROUP BY s.supplierId, s.companyName\nORDER BY productsCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti senza ordini (mai)"}, {"role": "assistant", "content": "SELECT c.custId, c.companyName\nFROM Customer c\nLEFT JOIN SalesOrder o ON o.custId = c.custId\nWHERE o.orderId IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Valore medio per ordine per shipCountry"}, {"role": "assistant", "content": "SELECT o.shipCountry,\n       AVG(order_total) AS avgOrderValue\nFROM (\n  SELECT od.orderId,\n         SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS order_total\n  FROM OrderDetail od\n  GROUP BY od.orderId\n) t\nJOIN SalesOrder o ON o.orderId = t.orderId\nGROUP BY o.shipCountry\nORDER BY avgOrderValue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti esauriti (unitsInStock=0) e unitsOnOrder (desc)"}, {"role": "assistant", "content": "SELECT p.productName, p.unitsInStock, p.unitsOnOrder\nFROM Product p\nWHERE p.unitsInStock = 0\nORDER BY p.unitsOnOrder DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti mai ordinati"}, {"role": "assistant", "content": "SELECT p.productId, p.productName\nFROM Product p\nLEFT JOIN OrderDetail od ON od.productId = p.productId\nWHERE od.orderId IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 10 clienti per fatturato (lifetime)"}, {"role": "assistant", "content": "SELECT c.companyName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount, 0))) AS revenue\nFROM SalesOrder o\nJOIN Customer c ON o.custId = c.custId\nJOIN OrderDetail od ON o.orderId = od.orderId\nGROUP BY c.custId, c.companyName\nORDER BY revenue DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di dipendenti per regione (via territori)"}, {"role": "assistant", "content": "SELECT r.regiondescription AS region, COUNT(DISTINCT e.employeeId) AS employees\nFROM Employee e\nJOIN EmployeeTerritory et ON e.employeeId = et.employeeId\nJOIN Territory t ON et.territoryId = t.territoryId\nJOIN Region r ON t.regionId = r.regionId\nGROUP BY r.regionId, r.regiondescription\nORDER BY employees DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini con freight superiore alla media"}, {"role": "assistant", "content": "SELECT o.orderId, o.freight, o.shipCountry\nFROM SalesOrder o\nWHERE o.freight > (SELECT AVG(freight) FROM SalesOrder);"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per dipendente e mese (YYYY-MM)"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname, DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nGROUP BY e.employeeId, e.firstname, e.lastname, ym\nORDER BY e.lastname, e.firstname, ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 10 paesi di spedizione per numero ordini"}, {"role": "assistant", "content": "SELECT o.shipCountry, COUNT(*) AS ordersCount\nFROM SalesOrder o\nGROUP BY o.shipCountry\nORDER BY ordersCount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Prodotti con stock <= reorderLevel"}, {"role": "assistant", "content": "SELECT p.productName, p.unitsInStock, p.reorderLevel\nFROM Product p\nWHERE p.unitsInStock <= p.reorderLevel\nORDER BY p.unitsInStock ASC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Valore totale ordini per cliente"}, {"role": "assistant", "content": "SELECT c.companyName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM Customer c\nJOIN SalesOrder o ON o.custId = c.custId\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY c.custId, c.companyName\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Sconto medio per shipCountry"}, {"role": "assistant", "content": "SELECT o.shipCountry, AVG(COALESCE(od.discount,0)) AS avgDiscount\nFROM SalesOrder o\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY o.shipCountry\nORDER BY avgDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Coppie di prodotti più ordinate insieme (top 10 per supporto)"}, {"role": "assistant", "content": "SELECT p1.productName AS productA, p2.productName AS productB, COUNT(*) AS jointOrders\nFROM OrderDetail a\nJOIN OrderDetail b ON a.orderId = b.orderId AND a.productId < b.productId\nJOIN Product p1 ON a.productId = p1.productId\nJOIN Product p2 ON b.productId = p2.productId\nGROUP BY p1.productId, p1.productName, p2.productId, p2.productName\nORDER BY jointOrders DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini spediti in ritardo (shippedDate > requiredDate)"}, {"role": "assistant", "content": "SELECT o.orderId, o.orderDate, o.requiredDate, o.shippedDate\nFROM SalesOrder o\nWHERE o.shippedDate > o.requiredDate;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ritardo medio per shipCountry (giorni)"}, {"role": "assistant", "content": "SELECT o.shipCountry, AVG(DATEDIFF(o.shippedDate, o.requiredDate)) AS avgDelay\nFROM SalesOrder o\nGROUP BY o.shipCountry\nORDER BY avgDelay DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero ordini e ultima data ordine per cliente"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(o.orderId) AS ordersCount, MAX(o.orderDate) AS lastOrder\nFROM Customer c\nLEFT JOIN SalesOrder o ON o.custId = c.custId\nGROUP BY c.custId, c.companyName\nORDER BY ordersCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ricavo per prodotto con categoria"}, {"role": "assistant", "content": "SELECT p.productName, cat.categoryName,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY p.productId, p.productName, cat.categoryId, cat.categoryName\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Spedizioni per corriere e mese"}, {"role": "assistant", "content": "SELECT s.companyName, DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS shipments\nFROM SalesOrder o\nJOIN Shipper s ON o.shipperid = s.shipperId\nGROUP BY s.shipperId, s.companyName, ym\nORDER BY s.companyName, ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato per dipendente"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY e.employeeId, e.firstname, e.lastname\nORDER BY revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti per regione (campo region di Customer)"}, {"role": "assistant", "content": "SELECT c.region, COUNT(*) AS customers\nFROM Customer c\nGROUP BY c.region\nORDER BY customers DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Clienti con il maggior numero di prodotti distinti acquistati"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(DISTINCT od.productId) AS distinctProducts\nFROM Customer c\nJOIN SalesOrder o ON o.custId = c.custId\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY c.custId, c.companyName\nORDER BY distinctProducts DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per prodotto e mese (conteggio righe d'ordine)"}, {"role": "assistant", "content": "SELECT p.productName, DATE_FORMAT(o.orderDate, '%Y-%m') AS ym, COUNT(*) AS lineCount\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN SalesOrder o ON od.orderId = o.orderId\nGROUP BY p.productId, p.productName, ym\nORDER BY p.productName, ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Categorie con sconto medio più alto"}, {"role": "assistant", "content": "SELECT cat.categoryName, AVG(COALESCE(od.discount,0)) AS avgDiscount\nFROM OrderDetail od\nJOIN Product p ON od.productId = p.productId\nJOIN Category cat ON p.categoryId = cat.categoryId\nGROUP BY cat.categoryId, cat.categoryName\nORDER BY avgDiscount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ordini per dipendente con percentuale di ritardo"}, {"role": "assistant", "content": "SELECT e.firstname, e.lastname, COUNT(*) AS ordersCount,\n       AVG(CASE WHEN o.shippedDate > o.requiredDate THEN 1 ELSE 0 END) AS lateRate\nFROM SalesOrder o\nJOIN Employee e ON o.employeeId = e.employeeId\nGROUP BY e.employeeId, e.firstname, e.lastname\nORDER BY lateRate DESC, ordersCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fornitori che coprono più categorie (prodotti)"}, {"role": "assistant", "content": "SELECT s.companyName, COUNT(DISTINCT p.categoryId) AS categories\nFROM Supplier s\nJOIN Product p ON p.supplierId = s.supplierId\nGROUP BY s.supplierId, s.companyName\nORDER BY categories DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Freight medio per corriere"}, {"role": "assistant", "content": "SELECT s.companyName, AVG(o.freight) AS avgFreight\nFROM SalesOrder o\nJOIN Shipper s ON o.shipperid = s.shipperId\nGROUP BY s.shipperId, s.companyName\nORDER BY avgFreight DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di prodotti per paese del fornitore"}, {"role": "assistant", "content": "SELECT s.country, COUNT(*) AS products\nFROM Product p\nJOIN Supplier s ON p.supplierId = s.supplierId\nGROUP BY s.country\nORDER BY products DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Numero di clienti per tipo demografico (se presenti)"}, {"role": "assistant", "content": "SELECT d.customerTypeId, COUNT(DISTINCT ccd.custId) AS customers\nFROM CustomerDemographics d\nJOIN CustCustDemographics ccd ON ccd.customerTypeId = d.customerTypeId\nGROUP BY d.customerTypeId\nORDER BY customers DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Dipendenti per titolo professionale (title)"}, {"role": "assistant", "content": "SELECT e.title, COUNT(*) AS employees\nFROM Employee e\nGROUP BY e.title\nORDER BY employees DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top 10 clienti per numero ordini negli ultimi 12 mesi"}, {"role": "assistant", "content": "SELECT c.companyName, COUNT(*) AS ordersCount\nFROM SalesOrder o\nJOIN Customer c ON o.custId = c.custId\nWHERE o.orderDate >= DATE_SUB(CURDATE(), INTERVAL 12 MONTH)\nGROUP BY c.custId, c.companyName\nORDER BY ordersCount DESC\nLIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato mensile (YYYY-MM)"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.orderDate, '%Y-%m') AS ym,\n       SUM(od.quantity * od.unitPrice * (1 - COALESCE(od.discount,0))) AS revenue\nFROM SalesOrder o\nJOIN OrderDetail od ON od.orderId = o.orderId\nGROUP BY ym\nORDER BY ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ultima data di spedizione per cliente"}, {"role": "assistant", "content": "SELECT c.companyName, MAX(o.shippedDate) AS lastShipped\nFROM Customer c\nJOIN SalesOrder o ON o.custId = c.custId\nGROUP BY c.custId, c.companyName\nORDER BY lastShipped DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ricavo per categoria per anno con crescita YoY (%)"}, {"role": "assistant", "content": "WITH CatYear AS (\n SELECT YEAR(o.orderDate) AS yr, c.categoryId, c.categoryName,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Product p ON p.productId = od.productId\n JOIN Category c ON c.categoryId = p.categoryId\n GROUP BY YEAR(o.orderDate), c.categoryId, c.categoryName\n)\nSELECT cy.yr, cy.categoryName, cy.revenue,\n       (cy.revenue / NULLIF(LAG(cy.revenue) OVER (PARTITION BY cy.categoryId ORDER BY cy.yr),0) - 1) AS yoy\nFROM CatYear cy\nORDER BY cy.categoryName, cy.yr;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Top location (regione/paese) per categoria e anno per ricavo"}, {"role": "assistant", "content": "WITH Loc AS (\n SELECT YEAR(o.orderDate) AS yr, c.categoryId, c.categoryName,\n        COALESCE(o.shipRegion, o.shipCountry) AS loc,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Product p ON p.productId = od.productId\n JOIN Category c ON c.categoryId = p.categoryId\n GROUP BY YEAR(o.orderDate), c.categoryId, c.categoryName, COALESCE(o.shipRegion,o.shipCountry)\n),\nRanked AS (\n SELECT l.*, RANK() OVER (PARTITION BY l.yr, l.categoryId ORDER BY l.revenue DESC) AS rnk\n FROM Loc l\n)\nSELECT yr, categoryName, loc, revenue\nFROM Ranked\nWHERE rnk = 1\nORDER BY categoryName, yr;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Mediana del valore per ordine per categoria e anno"}, {"role": "assistant", "content": "WITH OrderVals AS (\n SELECT YEAR(o.orderDate) AS yr, c.categoryId, c.categoryName, o.orderId,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS val\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Product p ON p.productId = od.productId\n JOIN Category c ON c.categoryId = p.categoryId\n GROUP BY YEAR(o.orderDate), c.categoryId, c.categoryName, o.orderId\n),\nRanked AS (\n SELECT yr, categoryId, categoryName, val,\n        ROW_NUMBER() OVER (PARTITION BY yr, categoryId ORDER BY val) AS rn,\n        COUNT(*) OVER (PARTITION BY yr, categoryId) AS cnt\n FROM OrderVals\n)\nSELECT yr, categoryName, AVG(val) AS medianOrderValue\nFROM Ranked\nWHERE rn IN (FLOOR((cnt+1)/2), CEIL((cnt+1)/2))\nGROUP BY yr, categoryId, categoryName\nORDER BY categoryName, yr;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Quota Top-3 clienti per categoria e anno (ricavo e share)"}, {"role": "assistant", "content": "WITH CustRev AS (\n SELECT YEAR(o.orderDate) AS yr, c.categoryId, c.categoryName, o.custId,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Product p ON p.productId = od.productId\n JOIN Category c ON c.categoryId = p.categoryId\n GROUP BY YEAR(o.orderDate), c.categoryId, c.categoryName, o.custId\n),\nRanked AS (\n SELECT cr.*, RANK() OVER (PARTITION BY cr.yr, cr.categoryId ORDER BY cr.revenue DESC) AS rnk\n FROM CustRev cr\n),\nCatYear AS (\n SELECT YEAR(o.orderDate) AS yr, c.categoryId,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS catRev\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Product p ON p.productId = od.productId\n JOIN Category c ON c.categoryId = p.categoryId\n GROUP BY YEAR(o.orderDate), c.categoryId\n)\nSELECT r.yr, r.categoryName,\n       SUM(CASE WHEN r.rnk <= 3 THEN r.revenue ELSE 0 END) AS top3Revenue,\n       cy.catRev,\n       SUM(CASE WHEN r.rnk <= 3 THEN r.revenue ELSE 0 END) / NULLIF(cy.catRev,0) AS top3Share\nFROM Ranked r\nJOIN CatYear cy ON cy.yr = r.yr AND cy.categoryId = r.categoryId\nGROUP BY r.yr, r.categoryId, r.categoryName, cy.catRev\nORDER BY r.categoryName, r.yr;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Fatturato mensile tra due date (serie completa)"}, {"role": "assistant", "content": "WITH RECURSIVE Months AS (\n SELECT DATE('2006-01-01') AS dt, DATE('2007-01-01') AS end_dt\n UNION ALL\n SELECT DATE_ADD(dt, INTERVAL 1 MONTH), end_dt FROM Months\n WHERE DATE_ADD(dt, INTERVAL 1 MONTH) < end_dt\n),\nMonthly AS (\n SELECT DATE_FORMAT(o.orderDate, '%Y-%m') AS ym,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n WHERE o.orderDate >= '2006-01-01' AND o.orderDate < '2007-01-01'\n GROUP BY ym\n)\nSELECT DATE_FORMAT(m.dt, '%Y-%m') AS ym,\n       COALESCE(mo.revenue, 0) AS revenue\nFROM Months m\nLEFT JOIN Monthly mo ON mo.ym = DATE_FORMAT(m.dt, '%Y-%m')\nORDER BY ym;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Quota fornitore per prodotto (ricavo e share)"}, {"role": "assistant", "content": "WITH ProdSupp AS (\n SELECT p.productId, p.productName, s.supplierId, s.companyName,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM OrderDetail od\n JOIN Product p ON p.productId = od.productId\n JOIN SalesOrder o ON o.orderId = od.orderId\n JOIN Supplier s ON s.supplierId = p.supplierId\n GROUP BY p.productId, p.productName, s.supplierId, s.companyName\n),\nProdTotal AS (\n SELECT productId, SUM(revenue) AS totalRev\n FROM ProdSupp\n GROUP BY productId\n)\nSELECT ps.productName, ps.companyName, ps.revenue,\n       ps.revenue / NULLIF(pt.totalRev,0) AS supplierShare\nFROM ProdSupp ps\nJOIN ProdTotal pt ON pt.productId = ps.productId\nORDER BY ps.productName, supplierShare DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Repeat purchases per cliente e prodotto nell'intervallo [startDate, endDate]"}, {"role": "assistant", "content": "WITH Params AS (\n SELECT DATE('2023-01-01') AS startDate, DATE('2023-12-31') AS endDate\n),\nCustProdOrders AS (\n SELECT o.custId, od.productId, o.orderId\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Params p\n WHERE o.orderDate BETWEEN p.startDate AND p.endDate\n GROUP BY o.custId, od.productId, o.orderId\n),\nRepeats AS (\n SELECT cpo.custId, cpo.productId,\n        COUNT(DISTINCT cpo.orderId) AS orders,\n        GROUP_CONCAT(DISTINCT cpo.orderId ORDER BY cpo.orderId) AS orders_list\n FROM CustProdOrders cpo\n GROUP BY cpo.custId, cpo.productId\n HAVING COUNT(DISTINCT cpo.orderId) >= 2\n)\nSELECT r.productId, p.productName, r.custId, r.orders AS repeatCount, r.orders_list\nFROM Repeats r\nJOIN Product p ON p.productId = r.productId\nORDER BY r.productId, r.custId;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Corriere top per ricavo per categoria e anno"}, {"role": "assistant", "content": "WITH ShipCat AS (\n SELECT YEAR(o.orderDate) AS yr, c.categoryId, c.categoryName,\n        s.companyName,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n JOIN Product p ON p.productId = od.productId\n JOIN Category c ON c.categoryId = p.categoryId\n JOIN Shipper s ON s.shipperId = o.shipperid\n WHERE o.shipperid IS NOT NULL\n GROUP BY YEAR(o.orderDate), c.categoryId, c.categoryName, s.shipperId, s.companyName\n),\nRanked AS (\n SELECT sc.*, RANK() OVER (PARTITION BY sc.yr, sc.categoryId ORDER BY sc.revenue DESC) AS rnk\n FROM ShipCat sc\n)\nSELECT yr, categoryName, companyName AS topShipper, revenue\nFROM Ranked\nWHERE rnk = 1\nORDER BY categoryName, yr;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Valore medio ordine per regione/paese di spedizione (safe division)"}, {"role": "assistant", "content": "WITH Orders AS (\n SELECT o.orderId,\n        COALESCE(o.shipRegion, o.shipCountry) AS loc\n FROM SalesOrder o\n),\nOrderTotals AS (\n SELECT od.orderId,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS totalVal\n FROM OrderDetail od\n GROUP BY od.orderId\n),\nAgg AS (\n SELECT os.loc,\n        SUM(ot.totalVal) AS rev,\n        COUNT(*) AS ordersCount\n FROM Orders os\n JOIN OrderTotals ot ON ot.orderId = os.orderId\n GROUP BY os.loc\n)\nSELECT loc, rev / NULLIF(ordersCount,0) AS avgOrderValue\nFROM Agg\nORDER BY avgOrderValue DESC;"}]}
{"messages": [{"role": "system", "content": "You are an expert SQL assistant for the Northwind MySQL database.\nRules: output ONLY the final SQL query; use MySQL dialect; SELECT only;\nuse existing tables/columns; prefer explicit JOIN ON with correct FKs;\ncompute revenue as quantity*unitPrice*(1-COALESCE(discount,0)) when asked."}, {"role": "user", "content": "Ricavo annuo con crescita YoY tramite self-join su CTE (no autoreferenze)"}, {"role": "assistant", "content": "WITH YearRev AS (\n SELECT YEAR(o.orderDate) AS yr,\n        SUM(od.quantity*od.unitPrice*(1-COALESCE(od.discount,0))) AS revenue\n FROM SalesOrder o\n JOIN OrderDetail od ON od.orderId = o.orderId\n GROUP BY YEAR(o.orderDate)\n)\nSELECT curr.yr, curr.revenue,\n       (curr.revenue / NULLIF(prev.revenue,0) - 1) AS yoy\nFROM YearRev curr\nLEFT JOIN YearRev prev ON prev.yr = curr.yr - 1\nORDER BY curr.yr;"}]}